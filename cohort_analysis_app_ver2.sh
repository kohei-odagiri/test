#/bin/bash
for ((i=0; i<1; i++))
do
out_file="tmp.txt"
echo -n > $out_file
s1date=$1

# term=$(( ($(date -d"1 days ago" +%s) - $(date -ds1date" +%s))/86400 ))
term=$2-1
for ((i=0; i<=$term; i++))
do
sdate=$(date -d"$i days $s1date" +%F)
smdate=$(date +'%Y-%m-%d-%r' -d " `date +%Y-%m-%d-%r -d"$s1date"`") 

s2date=$(date +'%Y-%m-%d' -d "1 days $sdate")
s3date=$(date +'%Y-%m-%d' -d "3 days $sdate")
s7date=$(date +'%Y-%m-%d' -d "7 days $sdate")
s14date=$(date +'%Y-%m-%d' -d "14 days $sdate")
s21date=$(date +'%Y-%m-%d' -d "21 days $sdate")
s30date=$(date +'%Y-%m-%d' -d "30 days $sdate")
s45date=$(date +'%Y-%m-%d' -d "45 days $sdate")
s60date=$(date +'%Y-%m-%d' -d "60 days $sdate")
s90date=$(date +'%Y-%m-%d' -d "90 days $sdate")
s180date=$(date +'%Y-%m-%d' -d "180 days $sdate")
mdate=$(date +'%Y-%m-%d' -d "1 days ago `date +%Y-%m-01 -d"1 month $s1date"`") 
m1date=$(date +'%Y-%m-%d' -d "1 days ago `date +%Y-%m-01 -d"2 month $s1date"`")
m2date=$(date +'%Y-%m-%d' -d "1 days ago `date +%Y-%m-01 -d"3 month $s1date"`")
#N+3
m3date=$(date +'%Y-%m-%d' -d "1 days ago `date +%Y-%m-01 -d"4 month $s1date"`")
#N+4
m3date=$(date +'%Y-%m-%d' -d "1 days ago `date +%Y-%m-01 -d"4 month $s1date"`")

echo $sdate,$s1date,$s2date,$s7date,$s30date,$m1date,$m2date
# sdate="2015-2-23"

# kakin_uu_array=($(echo "
# select 
# u.user_id
# from 
# user_attrib u
# where
# u.reg_date >= unix_timestamp('$sdate')
# and
# u.reg_date <= unix_timestamp('$s2date')
# and
# u.date = unix_timestamp('$sdate') 
# and
# u.aff_code regexp '^(^$|apk|apd|aps)'
# ;" | mysql -s -hmd157 -uodagiri.kohei market -pDotiDiIt))
# user_list=$(echo ${kakin_uu_array[@]} | tr -s ' ' ',')
#echo $user_list

# saikai_uu_array=(38674,38813,49239,66429,97251,210589,224894,244404,296280,352334,433653,618911,663402,667343,903751,924615,1009378,1056967,1063276,1072697,1094114,1099478,1151307,1182945,1210704,1226676,1324224,1486415,1486986,1529271,1541237,1544694,1605047,1645179,1737276,1824396,1844668,1916411,1973473,1991567,2036567,2068715,2070397,2166126,2207923,2272967,2305854,2345227,2374728,2385659,2503115,2598298,2603039,2617181,2637508,2663681,2682569,2691816,2706754,2826763,2900440,2922073,2964190,2971910,3008937,3041245,3068454,3088028,3151156,3270791,3271282,3281679,3386774,3418331,3446337,3450239,3490821,3510255,3603483,3644903,3748700,3783920,3786885,3847891,3867665,3937702,3954073,4074494,4135041,4137597,4147349,4150524,4163981,4266317,4266651,4294586,4347891,4359932,4367931,4375470,4455049,4468042,4478734,4569257,4602358,4673789,4753723,4766194,4801201,4803768,4816431,4856266,4858459,4906134,4933550,4953104,4954228,4957691,4973264,4980154,4997606,5041144,5094726,5119822,5125739,5127953,5136637,5157642,5234280,5287885,5323007,5345192,5358882,5446941,5518116,5688955,5710457,5727937,5732487,5741127,5752000,5925047,5945649,5949148,6016223,6065202,6082952,6091516,6137750,6137973,6167643,6174566,6202040,6216952,6230001,6249653,6270507,6327672,6352934,6385059,6450352,6453525,6471083,6475345,6483993,6518681,6524825,6557130,6565125,6573697,6576854,6587984,6663022,6715668,6724143,6743270,6782206,6833315,6848390,6864770,6897122,6968335,6989280,7011045,7026730,7057078,7098258,7099677,7109313,7171668,7182431,7195978,7234604,7292783,7333997,7428746,7449322,7499057,7527166,7542919,7595271,7611279,7637827,7679590,7702362,7719293,7742755,7788492,7811073,7818452,7850522,7891367,7898734,7901054,7915700,7946104,8008477,8024821,8049289,8079300,8109675,8118669,8121803,8145043,8147652,8175077,8188060,8227230,8229243,8231107,8284836,8301449,8301486,8320787,8322598,8333499,8388026,8390582,8394237,8454566,8467466,8471654,8479465,8480781,8503076,8504748,8534026,8536646,8566136,8580014,8585424,8621956,8637578,8639329,8664823,8672809,8680174,8693672,8693738,8695018,8699265,8713766,8716636,8719074,8724639,8743007,8753759,8757330,8769322,8784511,8786202,8799410,8833139,8835217,8838988,8848512,8848647,8856824,8857829,8867409,8915213,8925465,8951040,8962690,8965411,9020031,9031205,9049187,9054951,9058301,9085849,9099761,9116218,9117422,9126207,9165864,9183090,9185521,9193915,9197538,9207268,9235403,9254046,9264540,9274529,9274988,9278272,9283187,9288166,9317551,9319032,9353339,9369576,9375472,9376736,9379371,9382863,9385989,9387574,9432736,9433550,9442353,9462721,9466081,9475902,9478302,9486068,9487802,9501186,9504830,9505476,9506303,9510290,9510559,9514137,9516208,9523365,9552780,9553129,9555655,9557367,9579175,9585775,9585892,9587929,9595357,9601282,9602072,9602336,9602443,9602482,9602738,9607287,9610567,9611760,9612444,9615974,9624519,9624908,9626657,9626755,37561,158933,376512,435192,530538,585855,740881,847677,866387,885443,933499,972398,989705,1077200,1102737,1138098,1307094,1478363,1489124,1514762,1518960,1596914,1612351,1899760,1900205,2000345,2187929,2214684,2234716,2252834,2272058,2337122,2445355,2458364,2472154,2480475,2486465,2661162,2668208,2736161,2764980,2772362,2867002,2877872,2946642,2968367,3034047,3220006,3356589,3385574,3412460,3508241,3553465,3559962,3565034,3594496,3811037,3830938,3863406,3886696,3989685,4006104,4041766,4066478,4067154,4247712,4372870,4414613,4538132,4590290,4619844,4690809,4768394,4773585,4880391,4910219,4937784,4983985,5045360,5066253,5137395,5144984,5243307,5269987,5273599,5371164,5382701,5587455,5588994,5602568,5669606,5717817,5848614,5848626,5874450,5889354,5955306,6103859,6208472,6266939,6302061,6339010,6363554,6374752,6378711,6381922,6387278,6407462,6527421,6591423,6613184,6762492,6785491,6848112,6848365,6957594,6964393,7010852,7014697,7030278,7043659,7095504,7156530,7178796,7272907,7337848,7355240,7403776,7407869,7417299,7576501,7587113,7686607,7747742,7759611,7786345,7786832,7844159,7874785,7920904,7931736,7949639,7992356,8074436,8082857,8101444,8104175,8140022,8153843,8167980,8180956,8254511,8276202,8281605,8331727,8360305,8404466,8409394,8425216,8506734,8515448,8525122,8537850,8538185,8556755,8565944,8585148,8595709,8595905,8597439,8604274,8608565,8653104,8654140,8680660,8706678,8738698,8749843,8773546,8781971,8783524,8786099,8797281,8822720,8854128,8856901,8868452,8875082,8887565,8891328,8952627,8974116,8983811,8999569,9008926,9009712,9047757,9050296,9056488,9071401,9081380,9097051,9099432,9108903,9126965,9129632,9133384,9141188,9172858,9193101,9194599,9208670,9228756,9253500,9267647,9275557,9280932,9292561,9303913,9335074,9357978,9366774,9374670,9397177,9422783,9431199,9436853,9475290,9494290,9494423,9503102,9503286,9504821,9506987,9507219,9514274,9514869,9519293,9519792,9521047,9521313,9531326,9532592,9535995,9542082,9544875,9545751,9550679,9551236,9551812,9554090,9559628,9564088,9571876,9577102,9579281,9587868,9590875,9594400,9595797,9602083,9602737,9602847,9603085,9603182,9603240,9603501,9603729,9607339,9607928,9627666,9627708,9627977,58847,62741,327806,437586,531397,569961,675572,925560,967538,1069692,1232626,1821882,1925403,2024066,2049726,2096109,2308923,2373905,2579842,2729536,2795593,2834250,2936079,2966813,3036640,3037391,3049681,3095833,3182957,3239265,3239904,3310338,3356107,3357914,3362111,3504547,3598303,3654941,3861370,3869132,3878082,3932313,4027482,4085633,4118885,4127895,4136733,4218138,4322811,4332035,4344276,4372804,4478981,4502182,4630281,4739411,4853086,4869211,5012766,5128966,5149804,5205339,5291882,5370852,5377274,5390271,5425352,5455577,5478951,5479785,5498746,5659374,5696963,5821543,5888106,5967553,5975594,5982931,6074412,6135704,6154706,6211752,6271394,6272074,6314731,6328348,6344227,6422379,6427144,6492229,6499169,6514531,6610766,6702888,6703533,6826072,6851786,6895219,6949616,7053261,7084319,7235209,7303033,7379471,7483010,7553661,7613956,7658126,7739469,7804938,7816851,7835788,7868000,7918878,7920072,7945427,7965387,7971154,7997508,8081253,8088334,8104155,8109996,8114416,8114613,8169605,8171099,8196829,8232359,8246485,8270780,8271393,8318733,8427745,8429407,8446794,8468699,8476964,8495155,8544942,8554391,8567322,8576433,8602533,8608453,8704806,8706544,8725069,8741955,8760871,8802681,8804954,8810155,8822095,8888763,8904484,8908280,8917777,8934548,8940532,8965662,8976975,8988832,9008724,9010304,9062403,9072601,9081904,9109979,9112366,9124687,9127880,9136557,9187458,9193697,9218907,9239081,9294526,9297535,9351279,9364823,9419784,9436635,9446783,9465138,9487397,9489153,9496937,9501591,9515293,9529993,9541924,9542614,9549379,9552151,9553283,9564208,9569585,9596137,9602810,9603447,9603857,9604242,9604247,9604349,9604449,9605567,9611264,9613973,255232,312092,340745,414386,589110,722221,865964,904619,968982,977247,1168516,1328252,1549045,1589104,1889507,1901168,1966413,1983608,2019007,2029028,2121416,2127222,2165850,2211903,2257279,2272521,2629300,2738211,2864497,2912684,3031164,3203516,3332752,3388459,3538373,3724955,3904205,3919891,3983927,4095822,4161722,4219214,4264436,4281452,4297320,4305464,4317343,4436108,4480632,4519600,4823477,5015538,5081634,5239375,5353927,5378781,5398499,5455086,5516750,5546122,5610341,5749667,5986218,6051710,6177579,6209300,6212910,6281708,6292027,6341159,6357250,6367672,6455330,6481860,6500495,6530464,6717996,6746737,6749731,6878603,6912618,6974032,7132171,7144904,7164795,7172744,7209926,7244121,7316919,7351114,7363157,7379545,7403270,7468048,7491599,7493091,7625569,7638925,7714379,7846554,7849180,7909394,7969049,7978111,7998336,8014473,8016337,8050486,8056435,8092919,8180505,8197734,8210025,8259017,8288031,8329415,8350036,8374680,8414555,8458092,8537540,8555082,8619126,8642101,8679047,8685693,8719025,8719650,8724947,8751185,8787331,8815964,8827598,8828838,8840264,8855999,8865002,8910263,8939628,9078754,9094570,9111969,9121627,9128000,9135152,9159942,9172965,9174569,9188707,9235387,9251777,9254232,9278199,9298088,9351514,9391019,9396319,9413428,9436149,9489872,9504191,9509419,9519407,9541675,9542981,9543241,9545724,9550356,9550593,9550666,9553239,9559352,9570923,9575133,9582880,9602073,9602922,9603337,9603478,9604788,9605002,9605186,9607542,9622468,9622886,9629588,26450,84835,212690,649613,703150,896893,898997,912256,916964,937474,955897,1019019,1056599,1081709,1082835,1130132,1174507,1196946,1341247,1459115,1826267,1887624,1957722,2131792,2146729,2251493,2372124,2477661,2572090,2583181,2610729,2634770,2640509,2763493,2794336,2845721,2863484,2979806,3036217,3141962,3232870,3388463,3664510,3734440,3851404,3852012,3852732,3882420,3888543,3931746,4003822,4017306,4022167,4143133,4262566,4297164,4377969,4385092,4435151,4451313,4526332,4587591,4600358,4751756,4762989,4883250,4895333,4933477,4992616,5008064,5010021,5022944,5091767,5111440,5166818,5170003,5314046,5316735,5353564,5520219,5527549,5537729,5584775,5695135,5772195,5936387,5944576,5954250,6081015,6289236,6358839,6408621,6457338,6480817,6532841,6540925,6614348,6669740,6799268,6911169,6915481,6970469,7101882,7161258,7279700,7319012,7352960,7384493,7384788,7414684,7470844,7472352,7516612,7532736,7666502,7671681,7682313,7751609,7975373,7999820,8002828,8038889,8082533,8133180,8136778,8162299,8166704,8229993,8249642,8252368,8321768,8383284,8431927,8446716,8495080,8537742,8538445,8570528,8580102,8614668,8629690,8657460,8692433,8698593,8751181,8776448,8780421,8858845,8867459,8930847,8937001,8941638,8966230,8982520,9019508,9055306,9071827,9077909,9223225,9234843,9321405,9322067,9322943,9330243,9375972,9394091,9414614,9426419,9473564,9477312,9478482,9482120,9485488,9518597,9521055,9534622,9535923,9539300,9545150,9547758,9549077,9584059,9597075,9605661,9617686,9630197,9630215,5862,92637,103022,121429,150744,229929,246198,267603,543059,546653,564754,582776,738679,795438,940608,1127170,1244821,1287725,1369885,1389606,1525061,1635776,1658203,1663447,2010813,2017716,2118827,2187044,2216607,2265385,2328604,2363649,2490123,2586083,2654662,2675123,2712162,2715700,2751282,2764586,2799730,2806986,2840092,2849679,2938900,2999808,3006142,3149750,3238627,3337674,3412969,3514239,3572463,3614640,3634377,3655797,3679866,3962587,4062187,4069293,4103064,4135607,4136205,4139713,4237487,4258087,4290696,4373758,4455493,4513457,4513478,4548991,4679730,4760319,4868892,4951321,5032243,5073141,5094888,5136463,5206984,5225822,5249152,5295415,5295895,5300939,5370500,5426399,5426583,5514293,5525274,5526593,5533501,5573141,5635258,5668265,5692990,5698344,5730177,5822777,5889020,5977979,6032546,6142100,6143668,6232373,6237255,6239593,6358197,6358404,6433665,6435412,6460134,6567085,6604864,6734954,6746397,7079356,7093837,7114960,7115435,7153733,7164003,7185283,7192967,7204555,7235538,7315358,7327712,7349748,7432439,7606755,7644669,7729376,7735394,7773709,7889939,7903109,7913133,8051233,8063089,8066965,8085545,8096052,8139644,8182634,8193587,8197179,8245832,8263286,8339399,8343139,8376330,8376843,8389448,8444935,8478649,8487517,8496373,8499896,8521622,8609414,8621810,8623138,8626876,8637173,8655586,8686455,8709448,8774530,8780778,8791953,8814147,8835533,8871918,8874766,8883536,8897425,8940617,8944718,8988800,8992285,9030591,9053788,9069440,9093879,9105367,9107317,9131341,9140279,9195721,9254451,9257083,9301387,9309968,9339069,9361983,9385568,9394250,9434612,9449970,9454539,9463793,9465838,9486139,9507813,9510783,9512927,9515237,9525407,9532356,9538155,9539669,9549793,9551908,9559642,9572625,9572865,9581023,9588915,9594991,9596044,9602087,9602468,9603126,9603671,9605219,9606089,9606141,9606162,9608141,9608443,9623793,9630978,9630994,9631057,9631091,9631102,9947,32927,63205,121572,404061,539134,594551,740654,816028,856714,903714,1028906,1112979,1135371,1188919,1257885,1283969,1293444,1449076,1585349,1685276,1809172,1926604,2082577,2100939,2196882,2415059,2472683,2479913,2488880,2582874,2675264,2703516,2799529,2825160,2989668,3121376,3198573,3220323,3247006,3304662,3318689,3453680,3487023,3651852,3744049,4154337,4188643,4254416,4267348,4334202,4348078,4446538,4464216,4495025,4503414,4642741,4690220,4702723,4765665,4838996,4869374,4891649,4917764,4961353,4977267,5051063,5125242,5417142,5492047,5508534,5627149,5677335,5687263,5703514,5713497,5792120,5830347,5942852,5960970,5977840,6296231,6363056,6433190,6686294,6688883,6765193,6767919,6870717,6926500,6951386,6956289,7015950,7165449,7422977,7746245,7858543,7858625,7860541,7932854,7963541,7984209,7986216,8016290,8056690,8075969,8095418,8096535,8108963,8247688,8266819,8301192,8306988,8399101,8402041,8466290,8484513,8490834,8537429,8553254,8579452,8614058,8646565,8653100,8667270,8671156,8708924,8845789,8849676,8872736,8882134,8923020,8941661,8963275,8981313,8985134,8997576,9068880,9070817,9087687,9139157,9186774,9202321,9210303,9221535,9228652,9295704,9302449,9311033,9319491,9321919,9323495,9324067,9358141,9378361,9394351,9396728,9400812,9404276,9432751,9450847,9460222,9462607,9487047,9537740,9560652,9573271,9582163,9584812,9589193,9591663,9603084,9603228,9603811,9604371,9604904,9605066,9606854,9611621,9613227,9632190,88440,118519,269055,426196,499878,568892,917783,1061856,1316360,1362499,1439522,1550554,1552327,1669291,1821857,1842383,1886725,1895147,1918590,2056864,2076553,2112101,2133004,2138547,2147862,2269559,2458631,2462700,2530166,2660308,2680587,2768652,3039379,3176183,3196736,3302737,3331142,3380628,3718279,3883712,3889026,4088118,4105188,4226799,4335948,4420922,4453636,4634268,4835252,4839497,4962831,4999213,5088955,5109097,5133992,5439058,5444801,5452994,5500607,5617034,5713632,5735761,5791786,5885116,6041301,6056782,6200928,6295116,6305651,6327675,6331472,6527128,6560524,6672730,6687655,6861015,6870011,6887825,6923674,6953650,7004205,7019797,7084263,7220373,7269460,7284136,7331443,7436604,7444925,7458112,7483699,7522445,7544251,7563446,7690634,7756080,7850783,7886477,7982082,8032063,8036984,8058808,8059817,8133248,8231831,8239999,8244701,8266424,8340719,8345166,8372173,8373361,8406868,8452600,8485519,8502986,8612962,8623078,8623454,8717745,8727028,8785782,8847124,8890200,8906879,8938276,8948246,8966318,9000315,9017755,9019850,9025458,9100864,9102677,9128290,9166708,9183674,9232071,9238773,9256778,9293802,9333924,9357376,9362915,9394126,9397411,9414043,9478300,9498774,9501876,9508149,9512122,9522357,9535868,9539959,9540002,9540861,9541251,9543547,9545850,9569540,9569630,9569792,9570630,9574686,9582234,9600299,9603492,9607139,9607270,9609535,9624491,9633855,10444,39894,60137,187170,302525,315399,638244,684898,1022282,1082028,1094202,1138922,1258518,1331944,1344877,1417248,1481162,1783557,1800470,1950652,1994867,2058437,2078323,2185764,2231356,2266981,2356882,2413555,2518980,2551375,2610818,2694826,2705456,2729443,2805818,2850099,2971937,3102032,3107968,3255499,3257702,3271551,3411853,3469879,3526748,3572128,3583504,3591736,3691429,3717546,3777798,3786667,3800743,3812763,3988548,4077730,4079653,4132222,4217616,4239479,4293381,4360517,4575159,4760873,4790675,4857426,4912493,4947266,5006261,5039760,5201078,5348622,5393416,5470259,5492444,5544445,5561635,5563814,5668363,5812850,5813486,5827811,5836288,5986870,6030784,6163479,6197417,6208364,6227969,6254230,6267252,6307057,6520749,6561210,6621114,6649270,6671339,6678936,7286064,7371473,7516596,7577778,7645472,7765014,7904949,7981199,7985801,7999804,8029114,8115428,8265304,8290230,8347645,8373074,8375320,8383403,8500691,8518375,8574725,8585399,8609470,8614458,8636856,8649298,8681573,8743234,8745718,8750058,8782874,8797156,8808376,8811764,8847066,8889999,8924031,8960500,8972168,8973355,8982509,8987259,9066344,9146749,9155400,9166358,9189057,9249606,9268149,9277808,9360741,9369389,9394670,9437095,9457883,9464606,9480119,9495118,9502400,9513000,9530853,9538959,9562044,9562461,9569961,9603661,9606041,9607897,9611595,9613466,9634355,9636020,85563,129938,130229,278353,325153,350504,391164,433146,483614,578885,844559,868537,943006,1088985,1141425,1193543,1246591,1586997,1819572,1853280,1916553,1969956,2138472,2166460,2260746,2340640,2376969,2471579,2614098,2677185,2726234,2856356,2984570,3044840,3191684,3343788,3398130,3443611,3568551,3618178,3660736,3684590,3705221,3713642,3894681,4112109,4162414,4499938,4566018,4661352,4800340,4921398,4944781,4974328,5057151,5081226,5108204,5128711,5220214,5248718,5281517,5306661,5332237,5337900,5354179,5645332,5800175,5985698,6020886,6036120,6048392,6083688,6088239,6097646,6180131,6257361,6301898,6348419,6388594,6970307,7154837,7159444,7198354,7255968,7285898,7314584,7346134,7455462,7502106,7539276,7687447,7700211,7702983,7707230,7739374,7757373,7797990,7824677,7847775,7865249,7884287,7904528,7909707,8025276,8028115,8040276,8097995,8252363,8276811,8291416,8318607,8331774,8371686,8387775,8413795,8418472,8445152,8538189,8539044,8621733,8625539,8653705,8656576,8680301,8697128,8735570,8757308,8771271,8869632,8922162,8928935,8945205,8955627,9000139,9004083,9011946,9023145,9062455,9133785,9149284,9167624,9173199,9194620,9215291,9219162,9229053,9307078,9377564,9393719,9399078,9402950,9414023,9438732,9450207,9483889,9545146,9545466,9552238,9555895,9562042,9564608,9565548,9574280,9590613,9603439,9605834,9608303,9608322,63710,72266,159904,191990,419032,732288,827821,892169,929773,1025447,1144751,1280182,1524923,1591178,1613638,1745930,1883700,1989509,2253755,2319692,2321413,2527201,2572218,2683203,2745563,2877692,2972707,2996679,3002062,3245391,3297147,3315964,3333397,3444462,3482652,3499151,3586120,3846264,3963354,3977072,3990519,4045345,4072262,4145064,4226141,4250421,4290288,4319230,4328627,4354743,4362930,4579155,4744143,4803528,4891933,5002650,5087669,5137599,5146194,5327818,5334104,5379405,5421382,5709186,5714350,5749522,5794237,5904593,6007070,6019053,6046454,6334238,6362741,6401128,6498033,6642370,6661280,6699297,6746204,6750383,6946926,7127858,7132003,7227030,7303567,7324011,7361610,7421047,7431401,7451274,7531888,7641788,7676912,7752747,7773967,7815835,7906617,7909560,7923898,8167843,8268332,8296608,8348728,8360029,8369737,8388966,8399115,8406332,8428963,8506475,8519976,8543277,8547393,8637257,8640270,8641201,8660261,8686276,8706487,8709790,8720361,8740587,8805210,8812983,8848116,8879134,8882518,8916464,8919342,8920381,8923005,8930194,8969993,9030726,9102987,9138668,9195839,9228297,9416936,9433077,9455798,9464222,9477189,9492024,9551638,9570667,9587586,9598695,9603000,9603732,9608283,9608743,9609113,9609174,9610340,9615024,9637976,63784,63866,147814,247464,448252,632835,686773,836241,840460,944895,1044289,1282477,1366478,1430621,1723893,1839813,1853218,2076783,2271096,2285199,2367886,2385918,2397972,2406721,2449484,2470393,2678730,2767754,2806768,2817738,2823463,2989666,3020465,3266450,3276956,3325419,3667433,3711235,3712039,3736382,3758744,3794161,3887364,4016807,4168452,4275310,4366291,4557035,4589652,4657106,4665583,4676330,4793885,5254698,5355439,5398656,5423232,5495070,5561332,5625472,5924038,6019463,6029227,6067274,6109101,6145666,6223392,6324277,6345492,6500133,6522011,6707090,6746491,6905276,7247177,7290854,7318684,7323734,7340688,7490789,7498953,7636975,7664192,7668891,7761537,7848525,7854180,7860809,7896466,7907919,7938521,7942970,7959523,8131767,8150928,8285460,8356351,8386731,8553047,8619995,8621214,8653673,8684528,8741971,8760181,8805465,8808932,8817818,8842213,8901576,8922511,8991996,9014396,9025566,9041486,9051753,9117200,9186765,9207697,9222067,9248332,9249241,9251035,9251758,9259260,9266127,9293533,9351685,9358730,9371944,9387661,9410321,9464857,9468097,9481791,9514806,9526303,9529648,9530320,9571853,9579052,9587528,9589644,9592586,9597393,9600194,9602747,9605823,9608347,9609936,9610001,9612016,9638522,9638767,126874,546896,601683,690338,733571,866211,974297,1255324,1399750,1843458,2292137,2493502,2808847,2813307,2815317,2818316,2824941,2962936,2983535,3042674,3062746,3218151,3473910,3661095,3771566,3791943,3882331,3945025,3972306,4077157,4283446,4334996,4546766,4553008,4560964,4897927,4909390,4974567,5127598,5177121,5182603,5431105,5442239,5482629,5789136,5803825,5891081,5899711,6009609,6016529,6066734,6371157,6371442,6410243,6421959,6578239,6762299,6953051,6955198,7143123,7190045,7289018,7413338,7472302,7702295,7719362,7843506,7921929,7928272,7986209,8002734,8072327,8136380,8167658,8327719,8406835,8511860,8518867,8522708,8545554,8571535,8623603,8653667,8729142,8761900,8798223,8843512,8847618,8852307,8855820,8879729,8880104,8882092,8899038,8918014,8942579,9033277,9072958,9094519,9126385,9166181,9189258,9240721,9271630,9327225,9329611,9338241,9373480,9397939,9404464,9460351,9481032,9484138,9536981,9546214,9553047,9577168,9583349,9585472,9587423,9592666,9603234,9603535,9603701,9606423,9607771,9609335,9609394,9610102,61234,610265,1025602,1458317,1573350,1729378,1788014,1808936,1816236,1896135,1920079,1920995,2010608,2214729,2370336,2376984,2484022,2556583,2564224,2630223,2702125,2716414,2741471,2966828,3196724,3331192,3733348,3746062,3879132,4082433,4092493,4104258,4171982,4232214,4364145,4465711,4475228,4547596,4559418,4617471,4647145,4727923,4843991,5080445,5251407,5364126,5451396,5486374,5494252,5649525,5663041,5825109,5896906,6033613,6072505,6105244,6345253,6350153,6384856,6615627,6711782,6846985,6929999,7007715,7454466,7461666,7482345,7557076,7568572,7612288,7618765,7700601,7795267,7836296,7880613,7932336,7991571,8050837,8075844,8103223,8145503,8200252,8204336,8248245,8271951,8285450,8293590,8294363,8297281,8299772,8346557,8367340,8408091,8431808,8474537,8502284,8513731,8545687,8579815,8615881,8629685,8636516,8642340,8730503,8786786,8787088,8846462,8853105,8858318,8870411,8888140,8888955,8929778,8996194,9022721,9126304,9132916,9146590,9168298,9198227,9238001,9293373,9305627,9310788,9367124,9368036,9460055,9519596,9519649,9548207,9565413,9566424,9572307,9599616,9602396,9602426,9603013,9603420,9603548,9603714,9603912,9607442,9610375,9617268,97937,233770,457588,653874,793230,815463,953901,1235940,1239044,1497477,1582505,1592315,1593089,1604887,1746874,1780456,1816739,1829353,1830600,1858017,1929804,2181210,2201755,2258422,2318823,2463992,2468725,2599740,2796549,2812730,2898257,2998281,3231715,3266799,3378158,3432202,3572718,3669743,3723795,3792118,3841917,3898589,4039381,4110970,4190899,4229224,4308160,4364147,4419266,4461447,4517696,4534150,4621839,4627625,4656974,4689696,4801124,4894098,4933648,5013348,5248536,5295608,5361226,5390451,5396307,5439312,5568531,5578478,5580949,5619716,5641883,5871459,6064290,6093897,6139541,6261859,6293318,6392704,6401926,6447697,6696844,6719633,6780273,6847718,6961860,7327331,7360619,7411280,7434545,7563506,7683229,7685749,7699364,7786169,7816511,7827019,7834180,7951702,7981543,8026861,8043204,8077622,8138966,8214035,8232350,8306014,8320044,8340676,8362555,8369042,8391570,8486009,8488631,8509211,8553373,8596029,8600698,8806354,8818521,8820555,8827728,8887487,8913979,8913989,8919312,8940667,8964612,8989612,9071613,9074388,9133348,9174051,9174651,9218978,9294953,9314552,9320653,9390224,9436740,9449784,9465346,9484947,9486628,9488142,9516026,9541035,9561629,9590274,9590420,9604758,9610882,41458,291901,344618,532857,629379,686846,695144,875611,912910,1049411,1263431,1485441,1599450,1926540,2147401,2348126,2829255,2911487,3070617,3320720,3374662,3389965,4035384,4061773,4150013,4191006,4404258,4665238,4766067,4823460,4940252,4956273,5012218,5175035,5339934,5467743,5519456,5526642,5635563,5838732,5981039,6033896,6065698,6246196,6256849,6317682,6334406,6344394,6352486,6430799,6494640,6511289,6519851,6539176,6614764,6687757,6736527,6875915,6901445,7044523,7057128,7150113,7519662,7546433,7566776,7570942,7577477,7633176,7713570,7779178,7791018,7835705,7883567,7924903,8028379,8128740,8165803,8204429,8254832,8255574,8269508,8299519,8306031,8309034,8420760,8430254,8431231,8454343,8518270,8556748,8569799,8619209,8626411,8661913,8683454,8743023,8759064,8795875,8803327,8813672,8874222,8898338,8898642,8945213,8955571,8963199,9018990,9028864,9030883,9050960,9141495,9164730,9208062,9211439,9236246,9247030,9273320,9341138,9342177,9351114,9362520,9444518,9461204,9462031,9484681,9535652,9541757,9545331,9548902,9564300,9565792,9566489,9569309,9586714,9601513,9602026,9604833,9608728,9611736,9612087,43505,119893,194505,568516,571808,761043,782282,787043,929147,996382,1378083,2794333,2838935,2937259,3171298,3186667,3314027,3490131,3508138,3684904,3944393,4015416,4082961,4176447,4198793,4322822,4371228,4425958,4517873,4737873,5062687,5074741,5200796,5235765,5244176,5424413,5425803,5572119,5764500,5888212,6073252,6102375,6165315,6284249,6375413,6380757,6521924,6567568,6612702,6625698,6664690,6694666,6751737,6800711,6835179,7152638,7309412,7506894,7533318,7548831,7676811,7798975,7804287,7882455,7890387,7899050,7930400,7946231,7954218,8111464,8145494,8192279,8227295,8235899,8269173,8330194,8338827,8410025,8421115,8426807,8466296,8584417,8640850,8647226,8665445,8677517,8691283,8718122,8846768,8852496,8860522,8906167,8916972,8921062,8957638,8976513,8989382,9035561,9056599,9076314,9099794,9134505,9161679,9244687,9291914,9337182,9352835,9356522,9380842,9387529,9390718,9413719,9457063,9487079,9497225,9504522,9531384,9531653,9533883,9547042,9555565,9568840,9569723,9588200,9612995,9613218,9642351,9642474,9642776,43405,54448,87624,92416,130340,239296,297424,332068,389564,421796,471879,509445,675533,809705,1015044,1035936,1149084,1241497,1331496,1774179,1961860,1968299,2360308,2680735,2700329,3102589,3178460,3188020,3225217,3572407,3576066,3609634,3895034,4074596,4111441,4275925,4294006,4322715,4377906,4413998,4469392,4713181,4821164,4890328,4909754,4973203,4988680,5087880,5389261,5442751,5597476,5740094,5769974,5796822,5933165,5939802,6081978,6122720,6182437,6401140,6480590,6494365,6602160,6706322,6801992,6887891,6922308,7223337,7632120,7646914,7724954,7840668,7898299,8038277,8083210,8121042,8162631,8240866,8461069,8478539,8500364,8611216,8720587,8724100,8729305,8760112,8902442,8931570,8956271,9017688,9109569,9177145,9205545,9253534,9344865,9345653,9348799,9478732,9500765,9507006,9530706,9543824,9543929,9561362,9576496,9585402,9608767,9608775,9609265,9609573,9610320,9610792,9085,32219,92810,158425,615385,708739,784311,876011,1126587,1161615,1178848,1350263,1730177,2162202,2238629,2251195,2365550,2383349,2424530,2507271,2529613,2756454,3307861,3360753,3396226,3453248,3558067,3715974,3732982,3752332,4203349,4239867,4295142,4341204,4346544,4397427,4441832,4447369,4485509,4508857,4509639,4561962,4569133,4606050,4623578,4654597,4663518,4713684,4727674,4789438,5069063,5145387,5189860,5239316,5269470,5345445,5424163,5642393,5645572,5804836,6071933,6244039,6260083,6346190,6348735,6478890,6503612,6510056,6562827,6586427,6676760,6736471,6747883,6948778,6992917,7027060,7162874,7213074,7231602,7256133,7272327,7375104,7553336,7582772,7689265,7741808,7759354,7769767,7892354,7917560,7927686,7964580,7971885,7976392,7981389,7987545,8021815,8095621,8128274,8135014,8156394,8205410,8250621,8418434,8464107,8536686,8544663,8550825,8938195,8995363,9045378,9058927,9081180,9107578,9116322,9144172,9153258,9167802,9168248,9180530,9241472,9377307,9470306,9477608,9521455,9537000,9540648,9588059,9593337,9610722,9611841,9612752,9612753,9614625,9643525,9643565,9643913,27481,103643,198463,234609,576464,967570,1060098,1350004,1670573,1846761,1906472,1923159,2056997,2244308,2360578,2462331,2468209,2608779,2943003,2982913,3105114,3139250,3206705,3244882,3259271,3284170,3302568,3483367,3560005,3668158,4154119,4256866,4281891,4361816,4397133,4598074,4648206,4678898,4756420,4814987,4833506,4870696,4935311,5082611,5120007,5224842,5271461,5352928,5576455,5692733,6137466,6392754,6504245,6556237,6587043,6629868,6660449,6750269,6757398,6759696,6807149,6916591,6963149,7074241,7149814,7200983,7272866,7316177,7500172,7752876,7788505,7789237,7805107,7805967,7807993,7808481,7812137,8074989,8155334,8169309,8224630,8225970,8226656,8270692,8498522,8500209,8538440,8540858,8549846,8597600,8607144,8630428,8639521,8852663,8964598,8990677,9059516,9109589,9138646,9141937,9218612,9223125,9267687,9302533,9303020,9320599,9359978,9463493,9478261,9479435,9508410,9513433,9571349,9571483,9602328,9609443,9615188,9615696,9616433,5264,260226,385105,439428,674128,830709,1206173,1587505,2229965,2276884,2314324,2386622,2456479,2605501,3175909,3280292,3463170,3560355,3579048,3708764,3782436,3796372,3872347,4043687,4214541,4291887,4452060,4657999,4662378,4724260,4800842,4802329,5042512,5108568,5359271,5361866,5378762,5504352,5557416,5749759,5835269,5988249,6019000,6226494,6283079,6303558,6510404,6636751,6867316,6877594,6899568,6930550,6946476,7181704,7333799,7337467,7459605,7498161,7630269,7630508,7699625,7780679,7860010,7933645,7974964,8199086,8308481,8313373,8314576,8371953,8385633,8414016,8428470,8434554,8446519,8464549,8517547,8534049,8536978,8624348,8656126,8659745,8700938,8706125,8707292,8777504,8785794,8798367,8867875,8928354,8976973,8977198,9047487,9089710,9131270,9183032,9209292,9246218,9252227,9267762,9287294,9303417,9484247,9523634,9582988,9586219,9594813,9611464,9613562,9615638,9616414,9616762,9616820,9645267,9645390,9645412,9645545,99614,380643,568795,648958,652150,882861,1129652,1154767,1183877,1364768,1422267,1477738,1479114,1603914,1643016,1783144,1926035,2017028,2086806,2096359,2222595,2270631,2296811,2401420,2428854,2503657,2561846,2691115,2719776,3245740,3279945,3356161,3368434,3416891,3436964,3595844,3762511,3857825,4088831,4090914,4336668,4960678,5017403,5518353,5842993,5943617,6010331,6185760,6429302,6505479,6560750,6587213,6696093,6705172,6879094,6883526,7127647,7167591,7283512,7587233,7680028,7791034,7791921,7807647,7960261,8145825,8197550,8231599,8316618,8376608,8378805,8411050,8420402,8421631,8456486,8458849,8461482,8503467,8514038,8520847,8522190,8637829,8649959,8686092,8748798,8774068,8774153,8787365,8795570,8811599,8849929,8908250,8956976,8959996,8993753,9037547,9153351,9212358,9270918,9304810,9363131,9384035,9443229,9463395,9539918,9543634,9543995,9544467,9554221,9559545,9569166,9607818,9608569,9615651,9615731,9616620,9617069,9617272,9617273,9617379,9617493,9617504,9617755,9617972,9618073,9618117,9640027,9646133,79988,243899,563982,579481,614622,733267,1446798,1463598,1716397,1915216,1928214,1950455,2001209,2075322,2183044,2542074,2738724,2925950,3020630,3041009,3456707,3583890,3667302,3775097,4097992,4157382,4267349,4310859,4761508,4768076,4836567,4839648,5035190,5154718,5352858,5378241,5803096,5904449,5970228,6053606,6074449,6119751,6214315,6268575,6294639,6309534,6322548,6368802,6388325,6406705,6505489,6534709,6685733,6708165,6735246,6778107,6832290,6852841,6927056,7202957,7292055,7330126,7370785,7450831,7482155,7653440,7887750,8060683,8128495,8159059,8223536,8240608,8245080,8422487,8580354,8584543,8616098,8849838,8901037,8939946,8962810,8971241,9088224,9132093,9163116,9182560,9220541,9270334,9291867,9450982,9470183,9478503,9489432,9506371,9507619,9513083,9528697,9533181,9534205,9566854,9575557,9604453,9605257,9611462,9613054,9613384,9614165,9616994,9617009,9617954,9618165,9618602,9618862,9618967,201488,212264,786751,1136911,1143510,1294096,1839826,1851451,1906491,1974959,2094292,2131927,2150707,2157118,2242747,2268785,2462994,2566571,2845941,2862238,2866427,3080267,3114680,3245649,3277452,3400436,3433056,3537755,3615054,3846374,3954940,4035204,4191823,4334080,4750671,4808414,5050495,5095328,5215380,5352322,5430283,5479169,5635588,5845974,5920733,6004935,6019332,6090072,6111693,6224361,6252077,6341924,6352886,6420658,6760725,6786287,6934071,6981825,6995856,6996779,7013868,7070078,7115204,7129907,7231162,7254690,7304560,7316346,7480948,7565662,7591284,7636173,8106015,8117027,8181682,8182011,8219358,8331534,8373162,8453916,8458168,8483648,8500563,8538444,8541741,8571243,8605169,8679572,8691632,8711041,8728214,8746611,8876838,8879424,8881229,8898954,8904137,9072395,9098487,9125843,9139883,9152263,9162247,9181467,9226844,9283239,9326905,9377501,9475700,9475845,9479157,9486767,9502605,9525832,9538690,9544007,9551771,9554686,9567119,9568275,9573398,9592615,9603965,9612260,9613128,9614404,9617064,9619162,9624075,9647850,9648060,9648107,69236,407415,821069,1454668,1737323,2058322,2403324,2409775,2540343,2610097,2645416,2689599,2698329,2807453,3079954,3178812,3220533,3226328,3500337,3602495,3669669,3896281,4211890,4438391,4634097,4866948,4870473,5000401,5072841,5186927,5237095,5250170,5545665,5554605,5560808,5683502,5963670,6017043,6050562,6109921,6191213,6275408,6364142,6370447,6513656,6708537,6790681,6810873,6978438,7017305,7040890,7124714,7260760,7384322,7438299,7512373,7531002,7608107,7650403,7657709,7680156,7695866,7749891,7903268,7937276,7943377,8027037,8035034,8088074,8096057,8186671,8310875,8320060,8341493,8374590,8401413,8542857,8618277,8622916,8673479,8704507,8727099,8727776,8732503,8744888,8776635,8805088,8805526,8810413,8832539,9027552,9039657,9070296,9142620,9232820,9254545,9256488,9501592,9553548,9588899,9605888,9609391,9610624,9611503,9612838,9613826,9619614,9620034,9620147,9620192,9620466,9620660,37790,54808,209390,234518,576352,582819,608165,611489,781566,1095190,1143499,1273308,1384154,1832299,1904809,1994435,2451047,3003963,3031906,3355232,3368605,3612926,3656495,3703345,3708674,4005790,4181875,4207153,4298400,4377001,4430843,4438757,4463143,4482079,4649426,4658534,4740992,4920524,4939391,4951900,5055561,5280209,5292232,5350576,5365505,5396786,5911475,6025990,6057296,6102456,6140054,6288392,6399713,6519438,6669361,7131394,7178446,7191444,7209602,7335420,7368270,7377011,7540533,7563303,7703250,7771116,7810466,7824883,7851022,7942409,8113245,8194523,8196285,8233439,8251500,8253649,8258500,8404876,8427543,8473075,8492597,8500223,8587765,8660007,8733750,8734515,8815306,8840227,8846359,8886617,9021437,9079592,9112702,9146676,9179213,9183973,9240532,9269541,9286996,9332236,9356519,9357890,9411839,9471922,9511763,9513243,9558852,9564967,9574131,9612818,9615253,9615369,9617369,9617472,9619241,9619808,9619925,9621637,9649203,100199,100399,1074342,1378054,1407945,1584839,1968347,2144036,2169174,2443983,2797952,2879411,3342654,3468316,3759795,3776955,3927610,4015721,4037982,4069123,4302263,4394441,4549316,4551058,4611332,4636241,4678867,4841119,4895877,4940017,4997471,5093887,5153168,5313905,5315425,5369843,5403163,5437330,5652193,5705743,5745242,5749918,5874640,5892895,6078865,6114784,6146326,6212622,6334766,6348467,6349208,6374139,6406226,6508562,6540822,6691769,6707157,6857927,6927855,6965022,7208717,7293543,7320095,7360523,7432142,7435422,7539238,7571990,7760676,7844234,8010217,8053086,8080851,8148170,8207507,8244237,8292853,8299632,8340090,8380479,8412729,8483667,8557797,8609267,8636766,8639934,8675067,8765288,8793970,8810054,8844915,8872977,8901463,8957680,9001785,9083706,9128511,9141791,9179000,9186555,9195781,9219130,9247395,9333566,9336768,9342968,9377947,9379958,9408027,9426472,9456876,9467187,9502051,9506368,9537239,9569013,9578052,9592173,9601050,9604009,9604737,9608077,9609751,9611918,9614120,9615060,9616287,9617284,9621512,9622021,9622172,9622514,9622567,9650305,9650522,87376,639875,766531,806478,911098,1091435,1406804,1458091,1528409,1678828,1875290,1887857,2014644,2222372,2383025,2479143,2529991,2675717,2736468,2749782,2755803,2756906,2811782,2981428,3118226,3400632,3444751,3527255,3556510,3651866,3845666,3918625,3924392,4084994,4217564,4222622,4271670,4577936,4833899,4871692,5049093,5116889,5343007,5447626,5538996,5770301,6032350,6094193,6296849,6666667,6675608,6739894,6919528,6930014,6983049,7204659,7216134,7222721,7373340,7409170,7483277,7818151,7868958,7946740,7978545,8024421,8070648,8123565,8154856,8161382,8244144,8255439,8319863,8457736,8506048,8535837,8589312,8611221,8702027,8714344,8717431,8720728,8722891,8758224,8763529,8772620,8870389,8979920,9016245,9028648,9043522,9051066,9064179,9075059,9141751,9152185,9153917,9167647,9199301,9205682,9230988,9273966,9295557,9295663,9333905,9374142,9417552,9443287,9447480,9481633,9483195,9574338,9584114,9597625,9598378,9603179,9604979,9609632,9611228,9613358,9617067,9617226,9621329,9621521,9621764,9622861,9622966,9623394,9623478,9623753,9623816,9624579,9624940,9624941,9625208,9625218,9625225,9625229,9625246,9625247,9625248,9625249,9625250,9625508,318487,327966,359212,1149801,1759859,2256175,2367999,2454439,2551638,2899255,3681322,3941741,3958543,4318210,4327430,4462851,4581736,4640249,4672836,5047138,5061609,5111621,5181641,5281772,5352633,5356045,5435934,5537745,5605787,5850219,5959315,6078106,6107276,6136761,6154299,6158867,6269631,6460324,6574180,6629256,6645236,6726627,6778776,7129391,7205373,7213145,7560760,7587876,7626476,7676472,7678453,7943980,8074992,8077421,8083060,8179454,8251091,8325850,8358085,8378751,8405303,8461935,8542855,8546406,8593551,8614132,8616214,8654624,8670822,8687405,8742975,8764318,8766442,8842114,8889855,8981743,9024003,9129987,9162781,9163028,9163185,9164238,9205128,9214681,9282875,9332884,9389652,9411483,9458183,9483029,9559155,9579182,9597672,9602111,9604338,9604766,9611934,9612930,9613839,9623257,9623401,98119,118392,331792,365264,416685,454763,496084,611813,796483,854013,884253,1058512,1315559,1325962,1570684,1598884,1621458,1647180,1959842,2210060,2289871,2327641,2350428,2427331,2578977,2740607,2813558,2817892,2949276,2963117,2963883,3055485,3161443,3172149,3175642,3204594,3205110,3226614,3366186,3456006,3591240,3602459,3694244,3770846,3781885,3793384,3902963,3922912,3965704,3978108,4096097,4103300,4173724,4185366,4293568,4405372,4407086,4455859,4487120,4511628,4566241,4632309,4632678,4734291,4750179,4753981,4812530,4940655,5261688,5282632,5292709,5315532,5317087,5350664,5519666,5522442,5606884,5607952,5626646,5743184,6037394,6096710,6236548,6350752,6375798,6577658,6606672,6729205,6753502,6779314,6825064,6836842,6939113,7000445,7023766,7173196,7341828,7371288,7430730,7481293,7525084,7679256,7716259,7731776,7836177,7892176,7899577,7914079,7978925,8001061,8118806,8126918,8131435,8162599,8185629,8186664,8230828,8248304,8304861,8330157,8336067,8351556,8400893,8405191,8409907,8471602,8592658,8612883,8619691,8635886,8648618,8783075,8784611,8902464,8914399,9068088,9108621,9147512,9175911,9204811,9217914,9239206,9305851,9324459,9341550,9394019,9463726,9495779,9502642,9526379,9537415,9540258,9543515,9546373,9593727,9602129,9603562,9606598,9607168,9609999,9611336,9618197,9618969,9619999,9621112,9623277,9623292,9623807,9624225,9624565,9625721,102668,158006,413864,473358,519772,649583,722578,1317920,1429557,1459893,1526950,1554738,1617555,1824199,1992530,2839868,3111786,3121050,3191023,3207809,3288380,3689413,3751585,4060944,4199562,4290367,4384412,4394404,4613323,4666107,4679133,4803483,4870164,4983897,5179603,5301501,5350099,5402193,5735469,5975669,6135660,6278093,6430332,6478370,6550792,6654906,6701921,6771749,6808712,7223687,7317491,7341893,7663285,7734273,7804111,7861368,7880188,7990830,8016211,8064155,8082509,8101570,8295365,8320248,8332986,8363620,8376133,8376628,8463006,8566610,8665034,8677105,8686688,8753895,8777444,8783125,8931878,9075371,9089473,9111228,9136462,9178439,9274705,9310336,9329281,9353516,9460379,9474237,9552409,9563721,9590382,9601291,9603636,9603647,9603907,9605234,9606403,9607970,9608592,9608735,9608818,9609037,9609728,9610915,9611832,9613306,9615315,9615539,9617969,9618301,9618764,9618995,9619596,9621993,9622176,9622406,9623493,9624684,9625401,9625624,9625730,9653280)
saikai_uu_array=(38674)
user_list=$(echo ${saikai_uu_array[@]} | tr -s ' ' ',')
echo $user_list

echo "
select
date_format(from_unixtime(u.reg_date), '%Y-%m-%d'),
date_format(from_unixtime(k.date), '%Y-%m-%d'),
u.user_id,
if(s.ez_chk,'0sp-A',if(s.dcm_chk,'0sp-D',if(s.sb_chk,'0sp-V',if(m.model_name is null, if(u.career='A' or u.career='D' or u.career='V', concat('1fp-',u.career),'PC'), concat('0sp-',m.career)) ))) as cont,
# date_format(from_unixtime(t.date), '%Y-%m-%d'),
u.avail_st,

(
select
avail_st
from 
user_attrib
where
user_id in ($user_list)
and
date = unix_timestamp('$s2date') 
and
user_id = u.user_id
group by date
) as avail_1,

(
select
avail_st
from 
user_attrib
where
user_id in ($user_list)
and
date = unix_timestamp('$s3date') 
and
user_id = u.user_id
group by date
) as avail_3,

(
select
avail_st
from 
user_attrib
where
user_id in ($user_list)
and
date = unix_timestamp('$s7date') 
and
user_id = u.user_id
group by date
) as avail_7,

(
select
avail_st
from 
user_attrib
where
user_id in ($user_list)
and
date = unix_timestamp('$s14date') 
and
user_id = u.user_id
group by date
) as avail_14,

(
select
avail_st
from 
user_attrib
where
user_id in ($user_list)
and
date = unix_timestamp('$s21date') 
and
user_id = u.user_id
group by date
) as avail_21,

(
select
avail_st
from 
user_attrib
where
user_id in ($user_list)
and
date = unix_timestamp('$mdate') 
and
user_id = u.user_id
group by date
) as avail_30,

(
select
avail_st
from 
user_attrib
where
user_id in ($user_list)
and
date = unix_timestamp('$m1date') 
and
user_id = u.user_id
group by date
) as avail_60,

(
select
avail_st
from 
user_attrib
where
user_id in ($user_list)
and
date = unix_timestamp('$m2date') 
and
user_id = u.user_id
group by date
) as avail_90,

(
select
avail_st
from 
user_attrib
where
user_id in ($user_list)
and
date = unix_timestamp('$m3date') 
and
user_id = u.user_id
group by date
) as avail_180,

u.user_st,
g.mmgok_flg,
k.kakin_type,
u.sex_type,
u.birthday,
(YEAR(from_unixtime(u.reg_date))-YEAR(u.birthday)) - (RIGHT(from_unixtime(u.reg_date),5)<RIGHT(u.birthday,5)),

left(u.aff_code,3) as affabse

from
user_attrib u
left join
sp_user s
on
u.user_id = s.user_id and
# 当日
s.date <= unix_timestamp('$sdate') 
# 翌日
# s.date <= unix_timestamp('$s2date') 
# 3日後
# s.date <= unix_timestamp('$s3date') 
# 7日後
# s.date <= unix_timestamp('$s7date') 
left join
m_sp_model m
on
s.model_name = m.model_name
left join
tmp_last_access t
on
u.user_id = t.user_id 
left join
kakin_log k
on
u.user_id = k.user_id
left join
mmgok_flg g
on
u.user_id = g.user_id
left join
my_favor_data f
on
f.user_id = u.user_id
# and
# g.date = unix_timestamp('sdate')
where
u.date = unix_timestamp('$sdate')
and
u.user_id in ($user_list)
group by u.user_id
;" | mysql -s -hmd157 -uodagiri.kohei market -pDotiDiIt >> $out_file
done
done
cat tmp.txt

